
######## Snakemake header ########
import sys; sys.path.extend(["/home/pengjia/miniconda3/envs/default/lib/python3.7/site-packages", "/home/pengjia/ProjectSnake/snake-wrappers/bio//gatk3/indelrealigner"]); import pickle; snakemake = pickle.loads(b'\x80\x03csnakemake.script\nSnakemake\nq\x00)\x81q\x01}q\x02(X\x05\x00\x00\x00inputq\x03csnakemake.io\nInputFiles\nq\x04)\x81q\x05(XK\x00\x00\x00../../ngs_test_data/data2/align/HG001/N/HG001_N_fastp_bwa_picardMarkDup.bamq\x06XO\x00\x00\x00../../ngs_test_data/data2/align/HG001/N/HG001_N_fastp_bwa_picardMarkDup.bam.baiq\x07X8\x00\x00\x00../../ngs_test_data/data2/genome/GRCh38/GRCh38.d1.vd1.faq\x08Xc\x00\x00\x00/home/DATA/REFGENOMEDB/human/GRCh38.d1.vd1/variantsDB/1000G_phase1.snps.high_confidence.hg38.vcf.gzq\tXK\x00\x00\x00/home/DATA/REFGENOMEDB/human/GRCh38.d1.vd1/variantsDB/dbsnp_146.hg38.vcf.gzq\nXO\x00\x00\x00/home/DATA/REFGENOMEDB/human/GRCh38.d1.vd1/variantsDB/1000G_omni2.5.hg38.vcf.gzq\x0bXL\x00\x00\x00/home/DATA/REFGENOMEDB/human/GRCh38.d1.vd1/variantsDB/hapmap_3.3.hg38.vcf.gzq\x0cXv\x00\x00\x00/home/DATA/REFGENOMEDB/human/GRCh38.d1.vd1/variantsDB/Mills_and_1000G_gold_standard.indels.b38.primary_assembly.vcf.gzq\rXY\x00\x00\x00../../ngs_test_data/data2/align/HG001/N/HG001_N_fastp_bwa_picardMarkDup_reAlign.intervalsq\x0ee}q\x0f(X\x06\x00\x00\x00_namesq\x10}q\x11(X\x03\x00\x00\x00bamq\x12K\x00N\x86q\x13X\x03\x00\x00\x00baiq\x14K\x01N\x86q\x15X\x03\x00\x00\x00refq\x16K\x02N\x86q\x17X\x05\x00\x00\x00knownq\x18K\x03K\x08\x86q\x19X\x10\x00\x00\x00target_intervalsq\x1aK\x08N\x86q\x1buh\x12h\x06h\x14h\x07h\x16h\x08h\x18csnakemake.io\nNamedlist\nq\x1c)\x81q\x1d(h\th\nh\x0bh\x0ch\re}q\x1eh\x10}q\x1fsbh\x1ah\x0eubX\x06\x00\x00\x00outputq csnakemake.io\nOutputFiles\nq!)\x81q"XS\x00\x00\x00../../ngs_test_data/data2/align/HG001/N/HG001_N_fastp_bwa_picardMarkDup_reAlign.bamq#a}q$h\x10}q%sbX\x06\x00\x00\x00paramsq&csnakemake.io\nParams\nq\')\x81q((X&\x00\x00\x00/home/pengjia/miniconda3/envs/ngs/bin/q)X\x07\x00\x00\x00reAlignq*X\x00\x00\x00\x00q+X\t\x00\x00\x00 -Xmx10G q,e}q-(h\x10}q.(X\x04\x00\x00\x00pathq/K\x00N\x86q0X\x02\x00\x00\x00doq1K\x01N\x86q2X\x05\x00\x00\x00extraq3K\x02N\x86q4X\t\x00\x00\x00java_optsq5K\x03N\x86q6uh/h)h1h*h3h+h5h,ubX\t\x00\x00\x00wildcardsq7csnakemake.io\nWildcards\nq8)\x81q9(X\x05\x00\x00\x00HG001q:X\x01\x00\x00\x00Nq;X\x05\x00\x00\x00fastpq<X\x03\x00\x00\x00bwaq=X\r\x00\x00\x00picardMarkDupq>e}q?(h\x10}q@(X\x04\x00\x00\x00caseqAK\x00N\x86qBX\x06\x00\x00\x00sampleqCK\x01N\x86qDX\x06\x00\x00\x00qcpipeqEK\x02N\x86qFX\x07\x00\x00\x00alignerqGK\x03N\x86qHX\x07\x00\x00\x00markdupqIK\x04N\x86qJuX\x04\x00\x00\x00caseqKh:X\x06\x00\x00\x00sampleqLh;X\x06\x00\x00\x00qcpipeqMh<X\x07\x00\x00\x00alignerqNh=X\x07\x00\x00\x00markdupqOh>ubX\x07\x00\x00\x00threadsqPK\x01X\t\x00\x00\x00resourcesqQcsnakemake.io\nResources\nqR)\x81qS(K\x01K\x01e}qT(h\x10}qU(X\x06\x00\x00\x00_coresqVK\x00N\x86qWX\x06\x00\x00\x00_nodesqXK\x01N\x86qYuhVK\x01hXK\x01ubX\x03\x00\x00\x00logqZcsnakemake.io\nLog\nq[)\x81q\\XY\x00\x00\x00../../ngs_test_data/logs/align/HG001/N/HG001_N_fastp_bwa_picardMarkDup_reAlign-apply.logsq]a}q^h\x10}q_sbX\x06\x00\x00\x00configq`}qa(X\x08\x00\x00\x00caseinfoqbX\x11\x00\x00\x00conf/caseinfo.csvqcX\x07\x00\x00\x00projectqd}qeX\x04\x00\x00\x00nameqfX\x07\x00\x00\x00preTestqgsX\x07\x00\x00\x00wrapperqhX3\x00\x00\x00file:/home/pengjia/ProjectSnake/snake-wrappers/bio/qiX\x07\x00\x00\x00mainEnvqjX*\x00\x00\x00/home/pengjia/miniconda3/envs/PQsnake/bin/qkX\x05\x00\x00\x00qcEnvqlX(\x00\x00\x00/home/pengjia/miniconda3/envs/ngsqc/bin/qmX\t\x00\x00\x00path_dataqnX\x1a\x00\x00\x00../../ngs_test_data/data2/qoX\x08\x00\x00\x00path_logqpX\x19\x00\x00\x00../../ngs_test_data/logs/qqX\x07\x00\x00\x00path_bmqrX\x1e\x00\x00\x00../../ngs_test_data/benchmark/qsX\r\x00\x00\x00loadBamFormatqtX\x02\x00\x00\x00upquX\t\x00\x00\x00bamsampleqvX\x12\x00\x00\x00conf/bamsample.csvqwX\x04\x00\x00\x00pipeqx}qy(X\x04\x00\x00\x00trimqzX\x05\x00\x00\x00fastpq{X\x07\x00\x00\x00alignerq|X\x03\x00\x00\x00bwaq}X\x07\x00\x00\x00markdupq~X\r\x00\x00\x00picardMarkDupq\x7fX\x07\x00\x00\x00realignq\x80X\x07\x00\x00\x00reAlignq\x81X\x04\x00\x00\x00bqsrq\x82X\x08\x00\x00\x00noneBQSRq\x83X\t\x00\x00\x00leftAlignq\x84X\r\x00\x00\x00noneLeftAlignq\x85X\x07\x00\x00\x00fixMateq\x86X\x0b\x00\x00\x00noneFixMateq\x87X\x08\x00\x00\x00snpindelq\x88]q\x89(X\x02\x00\x00\x00HCq\x8aX\x0e\x00\x00\x00HC_Hard_filterq\x8bX\x07\x00\x00\x00HC_VQSRq\x8cX\x08\x00\x00\x00HC_Jointq\x8dX\x14\x00\x00\x00HC_Jonit_Hard_filterq\x8eX\r\x00\x00\x00HC_Joint_VQSRq\x8fX\x08\x00\x00\x00bcftoolsq\x90X\x06\x00\x00\x00pindelq\x91X\x07\x00\x00\x00varscanq\x92X\t\x00\x00\x00freebayesq\x93X\x0b\x00\x00\x00deepvariantq\x94eX\x05\x00\x00\x00svcnvq\x95]q\x96(X\x08\x00\x00\x00cnvnatorq\x97X\x06\x00\x00\x00metasvq\x98X\x05\x00\x00\x00dellyq\x99X\x05\x00\x00\x00lumpyq\x9aX\x06\x00\x00\x00smooveq\x9bX\x0b\x00\x00\x00breakdancerq\x9cX\x08\x00\x00\x00cnvnatorq\x9dX\x06\x00\x00\x00pindelq\x9eX\x06\x00\x00\x00metasvq\x9fX\x05\x00\x00\x00mantaq\xa0euX\x03\x00\x00\x00refq\xa1}q\xa2(X\x04\x00\x00\x00nameq\xa3X\x06\x00\x00\x00GRCh38q\xa4X\t\x00\x00\x00chrom_numq\xa5K\x19X\x06\x00\x00\x00genomeq\xa6XB\x00\x00\x00/home/DATA/REFGENOMEDB/human/GRCh38.d1.vd1/genome/GRCh38.d1.vd1.faq\xa7X\x05\x00\x00\x00dbsnpq\xa8XK\x00\x00\x00/home/DATA/REFGENOMEDB/human/GRCh38.d1.vd1/variantsDB/dbsnp_146.hg38.vcf.gzq\xa9X\x07\x00\x00\x001KGomniq\xaaXO\x00\x00\x00/home/DATA/REFGENOMEDB/human/GRCh38.d1.vd1/variantsDB/1000G_omni2.5.hg38.vcf.gzq\xabX\x08\x00\x00\x001KGp1snpq\xacXc\x00\x00\x00/home/DATA/REFGENOMEDB/human/GRCh38.d1.vd1/variantsDB/1000G_phase1.snps.high_confidence.hg38.vcf.gzq\xadX\x06\x00\x00\x00hapmapq\xaeXL\x00\x00\x00/home/DATA/REFGENOMEDB/human/GRCh38.d1.vd1/variantsDB/hapmap_3.3.hg38.vcf.gzq\xafX\x08\x00\x00\x00mills1KGq\xb0Xv\x00\x00\x00/home/DATA/REFGENOMEDB/human/GRCh38.d1.vd1/variantsDB/Mills_and_1000G_gold_standard.indels.b38.primary_assembly.vcf.gzq\xb1X\n\x00\x00\x00germMutuctq\xb2XM\x00\x00\x00/home/DATA/REFGENOMEDB/human/GRCh38.d1.vd1/Mutect2/af-only-gnomad.hg38.vcf.gzq\xb3uX\x07\x00\x00\x00threadsq\xb4}q\xb5(X\x0b\x00\x00\x00loadrawDataq\xb6K\x04X\x06\x00\x00\x00fastqcq\xb7K\x04X\x05\x00\x00\x00fastpq\xb8K\x04X\x06\x00\x00\x00passqcq\xb9K\x01X\x07\x00\x00\x00fastqc2q\xbaK\x04X\x07\x00\x00\x00multiqcq\xbbK\x01X\x03\x00\x00\x00Bwaq\xbcK\x08X\x08\x00\x00\x00MergeBamq\xbdK\x08X\x11\x00\x00\x00MarkDupWithPicardq\xbeK\x01X\x0b\x00\x00\x00NoneMarkDupq\xbfK\x01X\x14\x00\x00\x00MarkDupWithBiobambamq\xc0K\x04X\x0b\x00\x00\x00NoneRealignq\xc1K\x01X\x0e\x00\x00\x00GATKReAlignPreq\xc2K\x04X\x0b\x00\x00\x00GATKReAlignq\xc3K\x01X\x08\x00\x00\x00BamIndexq\xc4K\x08X\x08\x00\x00\x00NoneBQSRq\xc5K\x01X\x0b\x00\x00\x00GATKBQSRPreq\xc6K\x01X\x08\x00\x00\x00GATKBQSRq\xc7K\x01X\r\x00\x00\x00NoneLeftALignq\xc8K\x01X\r\x00\x00\x00GATKLeftAlignq\xc9K\x01X\x0b\x00\x00\x00NoneFixMateq\xcaK\x01X\x0b\x00\x00\x00GATKFixMateq\xcbK\x01X\t\x00\x00\x00LoadHQbamq\xccK\x01X\n\x00\x00\x00HC_CallVarq\xcdK\x04X\x05\x00\x00\x00HC_GTq\xceK\x04X\x0b\x00\x00\x00HC_MergeVCFq\xcfK\x04X\x0f\x00\x00\x00HC_CombineCallsq\xd0K\x04X\x0f\x00\x00\x00HC_GT_jointCallq\xd1K\x04X\x15\x00\x00\x00HC_MergeVCF_jointCallq\xd2K\x04X\x16\x00\x00\x00HC_JointCall_SelectSNVq\xd3K\x04X\x18\x00\x00\x00HC_JointCall_SelectIndelq\xd4K\x04X\x1b\x00\x00\x00HC_JointCall_FileterSNVHardq\xd5K\x04X\x1d\x00\x00\x00HC_JointCall_FileterINDElHardq\xd6K\x04X\x0c\x00\x00\x00HC_SelectSNVq\xd7K\x04X\x0e\x00\x00\x00HC_SelectIndelq\xd8K\x04X\x11\x00\x00\x00HC_FileterSNVHardq\xd9K\x04X\x13\x00\x00\x00HC_FileterINDElHardq\xdaK\x04X\n\x00\x00\x00FB_CallVarq\xdbK\x04X\t\x00\x00\x00FB_Filterq\xdcK\x04X\x10\x00\x00\x00Samtools_Mpileupq\xddK\x02X\x0c\x00\x00\x00Varscan_Callq\xdeK\x02X\x0e\x00\x00\x00Varscan_Filterq\xdfK\x02X\x10\x00\x00\x00Varscan_Call_SNVq\xe0K\x02X\x12\x00\x00\x00Varscan_Filter_SNVq\xe1K\x02X\x12\x00\x00\x00Varscan_Call_INDELq\xe2K\x02X\x14\x00\x00\x00Varscan_Filter_INDELq\xe3K\x02X\x10\x00\x00\x00Bcftools_Mpileupq\xe4K\x02X\r\x00\x00\x00Bcftools_Callq\xe5K\x02X\x0f\x00\x00\x00Bcftools_Filterq\xe6K\x02X\x06\x00\x00\x00MetaSVq\xe7K\x14X\x05\x00\x00\x00Mantaq\xe8K\x04X\n\x00\x00\x00Manta_confq\xe9K\x02X\n\x00\x00\x00Delly_Callq\xeaK\x02X\x08\x00\x00\x00Delly_GTq\xebK\x02X\x0f\x00\x00\x00Delly2Bcf2vcfgzq\xecK\x02X\x15\x00\x00\x00Lumpy_Get_Discordantsq\xedK\x02X\x14\x00\x00\x00Lumpy_Get_SplitReadsq\xeeK\x02X\x0c\x00\x00\x00Lumpyexpressq\xefK\x02X\x06\x00\x00\x00Smooveq\xf0K\x05X\x08\x00\x00\x00CNVnatorq\xf1K\x02X\x0b\x00\x00\x00BreakDancerq\xf2K\x02X\x10\x00\x00\x00BreakDancer_Confq\xf3K\x02uX\x06\x00\x00\x00paramsq\xf4}q\xf5(X\x04\x00\x00\x00gatkq\xf6}q\xf7(X\x0f\x00\x00\x00HaplotypeCallerq\xf8h+X\x10\x00\x00\x00BaseRecalibratorq\xf9h+X\r\x00\x00\x00GenotypeGVCFsq\xfah+X\x13\x00\x00\x00VariantRecalibratorq\xfbh+uX\x06\x00\x00\x00picardq\xfc}q\xfdX\x0e\x00\x00\x00MarkDuplicatesq\xfeX\x16\x00\x00\x00REMOVE_DUPLICATES=trueq\xffsX\x0b\x00\x00\x00trimmomaticr\x00\x01\x00\x00}r\x01\x01\x00\x00(X\x02\x00\x00\x00per\x02\x01\x00\x00}r\x03\x01\x00\x00X\x07\x00\x00\x00trimmerr\x04\x01\x00\x00]r\x05\x01\x00\x00(X\x0b\x00\x00\x00 LEADING:3 r\x06\x01\x00\x00X\x0c\x00\x00\x00 TRAILING:3 r\x07\x01\x00\x00X\x14\x00\x00\x00 SLIDINGWINDOW:4:15 r\x08\x01\x00\x00X\x0b\x00\x00\x00 MINLEN:36 r\t\x01\x00\x00esX\x02\x00\x00\x00ser\n\x01\x00\x00}r\x0b\x01\x00\x00X\x07\x00\x00\x00trimmerr\x0c\x01\x00\x00]r\r\x01\x00\x00(X\x0b\x00\x00\x00 LEADING:3 r\x0e\x01\x00\x00X\x0c\x00\x00\x00 TRAILING:3 r\x0f\x01\x00\x00X\x14\x00\x00\x00 SLIDINGWINDOW:4:15 r\x10\x01\x00\x00X\x0b\x00\x00\x00 MINLEN:36 r\x11\x01\x00\x00esuuuX\x04\x00\x00\x00ruler\x12\x01\x00\x00X\x0b\x00\x00\x00GATKReAlignr\x13\x01\x00\x00X\x0f\x00\x00\x00bench_iterationr\x14\x01\x00\x00K\x00X\t\x00\x00\x00scriptdirr\x15\x01\x00\x00XC\x00\x00\x00/home/pengjia/ProjectSnake/snake-wrappers/bio//gatk3/indelrealignerr\x16\x01\x00\x00ub.'); from snakemake.logging import logger; logger.printshellcmds = False; __real_file__ = __file__; __file__ = '/home/pengjia/ProjectSnake/snake-wrappers/bio/gatk3/indelrealigner/wrapper.py';
######## Original script #########
__author__ = "Patrik Smeds"
__copyright__ = "Copyright 2019, Patrik Smeds"
__email__ = "patrik.smeds@gmail.com.com"
__license__ = "MIT"

import os

from snakemake.shell import shell

extra = snakemake.params.get("extra", "")
java_opts = snakemake.params.get("java_opts", "")

input_bam = snakemake.input.bam
input_bai = snakemake.input.bai
input_known = snakemake.input.known
input_ref = snakemake.input.ref
input_target_intervals = snakemake.input.target_intervals

bed = snakemake.params.get("bed", None)
if bed is not None:
    bed = "-L " + bed
else:
    bed = ""

input_known_string = ""
for known in input_known:
    input_known_string = input_known_string + " -known {}".format(known)

log = snakemake.log_fmt_shell(stdout=True, stderr=True)
shell("{snakemake.params.path}gatk3 {java_opts} -T IndelRealigner"
      " {extra}"
      " -I {input_bam}"
      " -R {input_ref}"
      " {input_known_string}"
      " {bed}"
      " --targetIntervals {input_target_intervals}"
      " -o {snakemake.output}"
      " {log}")
